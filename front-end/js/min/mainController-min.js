var eComApp=angular.module("ecommerceApp",["ngRoute","ngCookies"]),eController=eComApp.controller("mainController",function(e,o,t,a,n){e.test="yo",e.userExists=!1;var s="http://localhost:3000";e.register=function(){console.log(e.username),t.post(s+"/register",{username:e.username,password:e.password,password2:e.password2,email:e.email}).then(function r(t){console.log(t.data),"inUse"===t.data.taken&&"no match"===t.data.message?e.errorMessage=!0:"inUse"===t.data.taken||"no match"===t.data.message?e.errorMessage=!0:e.errorMessage=!1,"inUse"===t.data.taken?e.userExists=!0:e.userExists=!1,"no match"===t.data.message?(e.noMatch=!0,console.log("passwords dont match")):e.noMatch=!1,"User Added"===t.data.message&&(n.put("token",t.data.token),n.put("username",e.username),o.loggedOut=!0,a.path("/options"))},function l(e){console.log(e)})},e.login=function(){t.post(s+"/login",{username:e.username,password:e.password}).then(function r(t){"badPass"===t.data.failure?(e.errorMessage=!0,e.noMatch=!0,console.log("bad password")):(e.errorMessage=!1,e.noMatch=!1),"userFound"===t.data.success&&(o.username=t.data.username,o.loggedOut=!0,console.log(o.loggedOut),n.put("token",t.data.token),n.put("username",e.username),a.path("/options")),"noUser"===t.data.failure&&console.log("Incorrect password")},function l(e){console.log(e)})},e.logout=function(){o.loggedOut=!0},http.get(s+"/getUserData?token="+n.get("token")).then(function r(e){console.log(e),"badToken"===e.data.failure?a.path="/login":"noToken"===e.data.failure&&a.path("/login")},function l(e){console.log(e)})});eComApp.config(function(e){e.when("/",{templateUrl:"views/main.html",controller:"mainController"}),e.when("/login",{templateUrl:"views/login.html",controller:"mainController"}),e.when("/register",{templateUrl:"views/register.html",controller:"mainController"}).otherwise({redirectTo:"/"})});